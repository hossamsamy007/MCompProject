package uk.ac.ncl.burton.twy.ZPK2;

import static org.junit.Assert.*;

import java.math.BigInteger;
import java.util.List;

import org.junit.Test;

import uk.ac.ncl.burton.twy.maths.CyclicGroup;
import uk.ac.ncl.burton.twy.utils.BigIntegerUtils;

public class ZPK2Testing {

	@Test
	public void test() {
		
		CyclicGroup G = CyclicGroup.generateGroup(256);
		BigInteger r = new BigInteger("41138432734464549107051107778342168767140819320451412658638359563426030926814");
		
		PoKProver peggy = PoKProver.generateProver(G, G.getG(), r);
		PoKVerifier victor = new PoKVerifier(G);
		System.out.println("Value: " + peggy.getValue());
		
		BigInteger t = peggy.getCommitment();
		System.out.println("Commitment: " + t);
		
		BigInteger c = BigIntegerUtils.randomBetween( BigInteger.ONE, G.getQ() );
		System.out.println("Challenge: " + c);
		
		List<BigInteger> s = peggy.getResponse(c);
		for( int i = 0 ; i < s.size(); i++ ){
			System.out.println("s" + (i+1) + ": " + s.get(i));
		}
		
		
		 
		
		
	}

}
